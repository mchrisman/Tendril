## CW 7. **Static analysis / linting **

This proposal introduces a **clarifying mode** for Tendril that asks users to *affirm intent* in cases where an expression is precise and correct, but plausibly misread.

The motivation is conversational rather than corrective. When a careful human hears a statement that is clear but easily mistaken, they naturally ask for confirmation: *“Just to be sure I understood you correctly…”* Clarifying mode applies the same principle to Tendril patterns.

#### What clarifying mode does

When clarifying mode is enabled, Tendril checks for **clauses whose surface form is commonly read as universal**, even though their semantics are existential. This typically occurs when:

* the key pattern can match many keys (e.g. `_`, regexes, alternation), and
* the value pattern is constraining, and
* no variable binding makes the existential intent explicit.

In such cases, Tendril emits a diagnostic that:

1. **States the actual meaning** of the clause (e.g. “this means *some* matching value satisfies …”).
2. **Asks for confirmation** if that is the intended meaning.
3. **Offers a clear alternative** for the universal interpretation.

Example message:

> This clause means **“some matching value satisfies …”**.
> Confirm with `/*intent:some*/`, or use `else !` (or `else !?`) for **“all”**.
> *(Clarifying mode.)*

Importantly, the tool never claims the clause is ambiguous or incorrect. The request is about *plausible miscommunication*, not semantics.

#### Affirming comments

To confirm existential intent, users add a short **affirming comment**, such as `/*intent:some*/`, adjacent to the clause. This comment does not change runtime semantics. It serves only to affirm intent and satisfy clarifying mode.

This mirrors well-established patterns like `@ts-expect-error`: an explicit acknowledgment that a potentially surprising construct is intentional.

#### Scope and philosophy

Clarifying mode is not “training wheels” or “don’t trust the user” mode. It is a precision mode that enhances readability and teachability by placing semantic emphasis on **intent**, not on suppressing warnings.

The mode is especially recommended for generated patterns (e.g. LLM output), but remains useful for humans working in high-precision contexts.

When clarifying mode is disabled, Tendril behaves exactly as it does today.

-----------

